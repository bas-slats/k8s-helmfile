# External Secrets - Vault ClusterSecretStore
# Provides cluster-wide access to Vault secrets
---
# Bootstrap token secret for Vault access
# In production, use Kubernetes auth instead of static token
apiVersion: v1
kind: Secret
metadata:
  name: vault-token
  namespace: external-secrets
type: Opaque
stringData:
  # This is a placeholder - update after Vault init
  # In production, use Kubernetes auth method instead
  token: "VAULT_ROOT_TOKEN_PLACEHOLDER"
---
# ClusterSecretStore for Vault
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: vault-backend
spec:
  provider:
    vault:
      server: "http://vault.vault.svc.cluster.local:8200"
      path: "secret"
      version: "v2"
      auth:
        tokenSecretRef:
          name: "vault-token"
          namespace: "external-secrets"
          key: "token"
---
# Alternative: Kubernetes auth (recommended for production)
# Requires Vault Kubernetes auth method to be configured
# apiVersion: external-secrets.io/v1beta1
# kind: ClusterSecretStore
# metadata:
#   name: vault-k8s-auth
# spec:
#   provider:
#     vault:
#       server: "http://vault.vault.svc.cluster.local:8200"
#       path: "secret"
#       version: "v2"
#       auth:
#         kubernetes:
#           mountPath: "kubernetes"
#           role: "external-secrets"
#           serviceAccountRef:
#             name: "external-secrets"
#             namespace: "external-secrets"
