# Grafana Tempo configuration
# Distributed tracing backend

# Single binary mode for homelab
tempo:
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      memory: 1Gi

# Storage configuration
persistence:
  enabled: true
  storageClassName: local-path
  size: 10Gi

# Tempo configuration
config: |
  multitenancy_enabled: false

  server:
    http_listen_port: 3100
    grpc_listen_port: 9095

  distributor:
    receivers:
      otlp:
        protocols:
          grpc:
            endpoint: 0.0.0.0:4317
          http:
            endpoint: 0.0.0.0:4318

  ingester:
    trace_idle_period: 10s
    max_block_bytes: 1000000
    max_block_duration: 5m

  compactor:
    compaction:
      compaction_window: 1h
      max_block_bytes: 100000000
      block_retention: 48h

  storage:
    trace:
      backend: local
      local:
        path: /var/tempo/traces
      wal:
        path: /var/tempo/wal

  querier:
    max_concurrent_queries: 20

  query_frontend:
    search:
      max_duration: 0

# Service for OTLP ingestion
service:
  type: ClusterIP
